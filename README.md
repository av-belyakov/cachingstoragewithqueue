# Пакет cachingstoragewithqueue

Пакет cachingstoragewithqueue реализует кэширующее хранилище произвольных объектов с очередью и обработкой этих объектов в автоматическом режиме. Для выполнения заданных действий над хранящимися объектами пользователем должны быть реализованы вспомогательные функции.

#### Подробно об использовании в примере ниже:

1. Инициализируем новое хранилище где 'any' любой тип данных который будет добавлятся в очередь и хранится в кэше как исходный объект. В тестах используется специально созданный интерфейс SpecialObjectComparator обладающий определённым набором методов:

```
	cache, err = cachingstoragewithqueue.NewCacheStorage[<тип_объекта>](
		context.Background(),
		cachingstoragewithqueue.WithMaxTtl[<тип_объекта>](int),
		cachingstoragewithqueue.WithTimeTick[<тип_объекта>](int),
		cachingstoragewithqueue.WithMaxSize[<тип_объекта>](int))
```

При инициализации хранилища запускается модуль CacheStorageWithQueue.automaticExecution обеспечивающий автоматическую обработку объектов добавленных в очередь. Этот модуль выполняет обработку объектов, хранение заданного максимального количества объектов, сравнение объектов на наличие дубликатов, удаление старых объектов. То есть объектов, срок жизни которых истёк или объектов, которые были успешно выполнены, если максимальное количество которых превышает допустимое значение выставляемое методом cachingstoragewithqueue.WithMaxSize.

2.  Добавление нового объекта в очередь:

```
cache.PushObjectToQueue(<тип_объекта>)
```

3. Получить размер очереди:

```
size := cache.SizeObjectToQueue()
```

Подробный пример использования пакета, можно посмотреть в файле package_test.go где для тестирования используются наборы типов и методов из пакета github.com/av-belyakov/objectsmispformat применяемых для упрощения взаимодействия с API MISP.
